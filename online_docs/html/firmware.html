
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Updating Firmware &#8212; ChipWhisperer 5.7.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="_static/backup.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
    <script src="_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Target API" href="target-api.html" />
    <link rel="prev" title="Scope API" href="scope-api.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">ChipWhisperer</h1>
    
  </a>
</p>



<p class="blurb">Side-Channel analysis tool-chain.</p>









  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Updating Firmware</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#windows-prerequisites">Windows Prerequisites</a></li>
<li><a class="reference internal" href="#linux-prerequisites">Linux Prerequisites</a></li>
<li><a class="reference internal" href="#mac-prerequisites">Mac Prerequisites</a></li>
<li><a class="reference internal" href="#virtualbox-prerequisites">VirtualBox Prerequisites</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrading-firmware">Upgrading Firmware</a></li>
<li><a class="reference internal" href="#programming-new-firmware">Programming New Firmware</a></li>
<li><a class="reference internal" href="#old-firmware-upgrade">Old Firmware Upgrade</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#firmware-upgrade-failed">Firmware upgrade failed</a></li>
<li><a class="reference internal" href="#could-not-find-bootloader-serial-port">Could not find bootloader serial port</a></li>
<li><a class="reference internal" href="#permission-error">Permission Error</a></li>
<li><a class="reference internal" href="#accidentally-flashed-incorrect-firmware">Accidentally flashed incorrect firmware</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="updating-firmware">
<span id="id1"></span><h1>Updating Firmware<a class="headerlink" href="#updating-firmware" title="Permalink to this heading">¶</a></h1>
<p>Received a message about a ChipWhisperer firmware update being available? Accidentally
erased the firmware on your ChipWhisperer? If so, this page contains all the information
you need to get your device up and running again!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All ChipWhisperer scopes and FPGA targets have a ROM base bootloader,
meaning it is effectively impossible to “brick” your ChipWhisperer
by updating or erasing its firmware.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This page only concerns firmware for ChipWhisperer scopes
and FPGA boards like the CW310 or CW305, not for integrated
targets or CW308 target boards</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This update method for updating firmware only works
for ChipWhisperer 5.6 and newer.
For ChipWhisperer versions earlier than 5.6, see <a class="reference internal" href="scope-api.html#api-scope-update"><span class="std std-ref">Firmware Update</span></a>.</p>
</div>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<section id="windows-prerequisites">
<h3>Windows Prerequisites<a class="headerlink" href="#windows-prerequisites" title="Permalink to this heading">¶</a></h3>
<p>If you are already running ChipWhisperer natively on Windows,
no steps are required before upgrading or flashing
new firmware onto your ChipWhisperer.</p>
<p>If you have ChipWhisperer installed and are unable to
connect due to not having the correct driver, follow the steps
shown at <a class="reference internal" href="drivers.html#windows-change-drivers"><span class="std std-ref">How to Change Drivers</span></a>.</p>
</section>
<section id="linux-prerequisites">
<h3>Linux Prerequisites<a class="headerlink" href="#linux-prerequisites" title="Permalink to this heading">¶</a></h3>
<p>If you are running natively on Linux, you will need to
ensure you have access to the serial ports. As of
ChipWhisperer 5.6, a rule in <code class="code docutils literal notranslate"><span class="pre">chipwhisperer/hardware/50-newae.rules</span></code>
will give serial port access to the current user</p>
<p>Older versions do not include this rule, so it is recommended to replace <code class="code docutils literal notranslate"><span class="pre">/etc/udev/rules.d/50-newae.rules</span></code>
with ChipWhisperer 5.6’s <code class="code docutils literal notranslate"><span class="pre">chipwhisperer/hardware/50-newae.rules</span></code>, then run <code class="code docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">udevadm</span> <span class="pre">control</span> <span class="pre">--reload-rules</span></code></p>
</section>
<section id="mac-prerequisites">
<h3>Mac Prerequisites<a class="headerlink" href="#mac-prerequisites" title="Permalink to this heading">¶</a></h3>
<p>Coming soon!</p>
</section>
<section id="virtualbox-prerequisites">
<h3>VirtualBox Prerequisites<a class="headerlink" href="#virtualbox-prerequisites" title="Permalink to this heading">¶</a></h3>
<p>In addition to the prerequisites for your guest system, you will also need
to ensure that the serial bootloader is being passed through from your host, like
with your other ChipWhisperer devices. To add a USB passthrough filter
for the bootloader, go to the settings for your VM &gt; USB and create a
new USB filter with the following settings:</p>
<blockquote>
<div><ul class="simple">
<li><p>Name: ATSAM Bootloader</p></li>
<li><p>Vendor ID: 03eb</p></li>
<li><p>Product ID: 6124</p></li>
</ul>
</div></blockquote>
<p>This should already be done on the ChipWhisperer VM, but may not be present on
older VMs.</p>
</section>
</section>
<section id="upgrading-firmware">
<span id="upgrade-firmware-python"></span><h2>Upgrading Firmware<a class="headerlink" href="#upgrading-firmware" title="Permalink to this heading">¶</a></h2>
<p>If you just need to update the firmware on your ChipWhisperer,
the easiest way is to connect to your ChipWhisperer as usual,
then call the <code class="code docutils literal notranslate"><span class="pre">upgrade_firmware()</span></code> method. For example,
upgrading a ChipWhisperer-Lite:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">chipwhisperer</span> <span class="k">as</span> <span class="nn">cw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scope</span> <span class="o">=</span> <span class="n">cw</span><span class="o">.</span><span class="n">scope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scope</span><span class="o">.</span><span class="n">upgrade_firmware</span><span class="p">()</span>
<span class="go">Entering bootloader mode...</span>
<span class="go">Detected com port COM13</span>
<span class="go">Loading cwlite firmware...</span>
<span class="go">Opened!</span>
<span class="go">Connecting...</span>
<span class="go">Connected!</span>
<span class="go">Erasing...</span>
<span class="go">Erased!</span>
<span class="go">Programming file SAM3U_CW1173.bin...</span>
<span class="go">Programmed!</span>
<span class="go">Verifying...</span>
<span class="go">Verify OK!</span>
<span class="go">Resetting...</span>
<span class="go">Upgrade successful</span>
</pre></div>
</div>
<p>If you don’t see the “Resetting…” line, you’ll need to power cycle your ChipWhisperer.</p>
</section>
<section id="programming-new-firmware">
<h2>Programming New Firmware<a class="headerlink" href="#programming-new-firmware" title="Permalink to this heading">¶</a></h2>
<p>If you’ve accidentally erased the firmware on your ChipWhisperer,
the best way to flash new firmware is to use ChipWhisperer’s
<code class="code docutils literal notranslate"><span class="pre">program_sam_firmware()</span></code> function. You will need
to specify the device you are upgrading from the following list:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘cwlite’</p></li>
<li><p>‘cw1200’</p></li>
<li><p>‘cwnano’</p></li>
<li><p>‘cwhusky’</p></li>
<li><p>‘cwbergen’</p></li>
<li><p>‘cw305’</p></li>
</ul>
</div></blockquote>
<p>For example, to flash new firmware to a CW305:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">chipwhisperer</span> <span class="k">as</span> <span class="nn">cw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cw</span><span class="o">.</span><span class="n">program_sam_firmware</span><span class="p">(</span><span class="n">hardware_type</span><span class="o">=</span><span class="s1">&#39;cw305&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="old-firmware-upgrade">
<h2>Old Firmware Upgrade<a class="headerlink" href="#old-firmware-upgrade" title="Permalink to this heading">¶</a></h2>
<p>For ChipWhisperer versions earlier than 5.6, see <a class="reference internal" href="scope-api.html#api-scope-update"><span class="std std-ref">Firmware Update</span></a>.</p>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading">¶</a></h2>
<section id="firmware-upgrade-failed">
<h3>Firmware upgrade failed<a class="headerlink" href="#firmware-upgrade-failed" title="Permalink to this heading">¶</a></h3>
<p>If <code class="code docutils literal notranslate"><span class="pre">scope.upgrade_firmware()</span></code>/<code class="code docutils literal notranslate"><span class="pre">target.upgrade_firmware()</span></code> fails
for any reason, use <code class="code docutils literal notranslate"><span class="pre">cw.program_sam_firmware()</span></code>.</p>
</section>
<section id="could-not-find-bootloader-serial-port">
<h3>Could not find bootloader serial port<a class="headerlink" href="#could-not-find-bootloader-serial-port" title="Permalink to this heading">¶</a></h3>
<p>Ensure the device is plugged in. If you’re using a VM,
ensure you have the USB device passed through.</p>
</section>
<section id="permission-error">
<h3>Permission Error<a class="headerlink" href="#permission-error" title="Permalink to this heading">¶</a></h3>
<p>If running on Linux, ensure you have the new <code class="code docutils literal notranslate"><span class="pre">50-newae.rules</span></code> file in
<code class="code docutils literal notranslate"><span class="pre">/etc/udev/rules.d/</span></code>, then run <code class="code docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">udevadm</span> <span class="pre">control</span> <span class="pre">--reload-rules</span></code>.</p>
<p>Additionally, try unplugging and replugging your ChipWhisperer. If the udev
rules have been applied properly, you should see a <code class="code docutils literal notranslate"><span class="pre">cw_bootloader%n</span></code>
device in <code class="code docutils literal notranslate"><span class="pre">/dev/</span></code>, where <code class="code docutils literal notranslate"><span class="pre">%n</span></code> is some integer.</p>
<p>If you’re still unable to program new firmware, try adding your user
to the <code class="code docutils literal notranslate"><span class="pre">dialout</span></code> group:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>usermod<span class="w"> </span>-a<span class="w"> </span>-G<span class="w"> </span>dialout<span class="w"> </span><span class="nv">$USER</span>
</pre></div>
</div>
<p>then logging out and back in again.</p>
</section>
<section id="accidentally-flashed-incorrect-firmware">
<h3>Accidentally flashed incorrect firmware<a class="headerlink" href="#accidentally-flashed-incorrect-firmware" title="Permalink to this heading">¶</a></h3>
<p>If the firmware you’ve flashed is for another NewAE device,
then, as of ChipWhisperer 5.7.1 or commit 068ec19, you can use
<code class="code docutils literal notranslate"><span class="pre">quick_firmware_erase()</span></code> as follows to erase the firmware on your
device:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chipwhisperer.hardware.naeusb.naeusb</span> <span class="kn">import</span> <span class="n">quick_firmware_erase</span>
<span class="n">quick_firmware_erase</span><span class="p">(</span><span class="o">&lt;</span><span class="n">product_id</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>replacing <code class="code docutils literal notranslate"><span class="pre">&lt;product_id&gt;</span></code> with the product ID of the firmware that you’ve
uploaded. For example, if you’ve uploaded ChipWhisperer-Lite (0xACE2) firmware to
your ChipWhisperer-Nano (0xACE0), you should use 0xACE2 as your product ID. You
may find it helpful to use <code class="code docutils literal notranslate"><span class="pre">cw.list_devices()</span></code> to list connected NewAE devices.</p>
<p>Otherwise, short the erase pins on your ChipWhisperer to
enter bootloader mode, then flash the correct firmware onto your device.</p>
<p>Instructions for shorting the erase pins can be found
on the documentation page for your device at <a class="reference external" href="https://rtfm.newae.com">https://rtfm.newae.com</a></p>
<p>If you run into any issues not covered here, or if none of these steps
work for you, let us know over at <a class="reference external" href="https://forum.newae.com">https://forum.newae.com</a></p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, NewAE Technology Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/firmware.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/newaetech/chipwhisperer" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>